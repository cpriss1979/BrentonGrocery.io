<body>
  <div class="app">
    <header>
      <h1 class="underline-title">Brenton‚Äôs Grocery List ‚Äî Home Edition</h1>
      <div class="toolbar">
        <input id="search" type="text" placeholder="Search items‚Ä¶ (e.g., milk, üçû)">
        <label class="switch"><input id="hidePurchased" type="checkbox"> Hide purchased</label>
        <button id="shareBtn" class="ghost">Share</button>
        <button id="exportBtn" class="ghost">Export</button>
        <label class="btn ghost" for="importFile">Import</label>
        <input id="importFile" type="file" accept="application/json" style="display:none">
        <button id="clearAll" class="danger">Clear all</button>
      </div>
<style>
  :root{
    --bg:#0b1b3a;         /* deep navy */
    --card:#101f44;       /* slightly lighter */
    --ink:#f7f7ff;        /* off-white text */
    --muted:#a7b4d6;      /* secondary text */
    --accent:#e8b8ff;     /* soft purple */
    --accent-2:#86e3ce;   /* minty green */
    --danger:#ff8e8e;     /* soft red */
    --ok:#b8f5b8;         /* soft green */
    --shadow:0 12px 40px rgba(0,0,0,.35);
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:600 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";}
  .app{max-width:760px;margin:0 auto;padding:20px;}
  header h1{margin:0 0 10px;font-weight:900;letter-spacing:.2px}
  header .toolbar{
    display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:12px
  }
  .card{
    background:var(--card);border:1px solid rgba(255,255,255,.08);
    border-radius:18px;box-shadow:var(--shadow);padding:14px;
  }
  input[type="text"], input[type="number"], select{
    background:#0e1d3f;border:1px solid rgba(255,255,255,.18);
    color:var(--ink);padding:12px 12px;border-radius:12px;outline:none;
  }
  input::placeholder{color:#9fb0df}
  input[type="number"]{width:84px}
  button, .btn{
    background:#000;border:2px solid #000;color:#fff;font-weight:800;
    padding:10px 12px;border-radius:12px;cursor:pointer;transition:transform .08s ease, opacity .2s ease;
  }
  button:hover{transform:translateY(-1px)}
  .ghost{background:transparent;border-color:rgba(255,255,255,.22);color:var(--ink)}
  .link{background:transparent;border:0;color:var(--accent);text-decoration:underline;padding:0}
  .ok{background:var(--accent-2);color:#0a172f;border-color:#0a172f}
  .danger{background:var(--danger);border-color:#2b0000}
  .toolbar input[type="text"]{flex:1;min-width:170px}
  .switch{display:flex;align-items:center;gap:6px}
  .switch input{accent-color:var(--accent)}
  .add{display:grid;gap:10px;margin:14px 0}
  .quick{display:flex;flex-wrap:wrap;gap:8px}
  .chip{
    background:#0e1d3f;border:1px solid rgba(255,255,255,.15);border-radius:999px;padding:8px 12px;cursor:pointer;
  }
  .chip b{margin-right:6px}
  form.add-row{display:grid;grid-template-columns:70px 1fr 92px 150px 110px;gap:8px}
  @media (max-width:700px){
    form.add-row{grid-template-columns:70px 1fr 92px; }
    .cat-wrap{grid-column:1 / span 2}
    .add-btn{grid-column:3}
  }
  .lists{display:grid;gap:14px;margin-top:10px}
  .list h2{margin:0 0 8px;font-size:18px}
  ul{list-style:none;margin:0;padding:0}
  li.item{
    display:grid;grid-template-columns:40px 1fr 90px 120px 40px;gap:8px;align-items:center;
    padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0e1d3f;
  }
  li.item + li.item{margin-top:8px}
  .it-emoji{font-size:24px;text-align:center}
  .it-name{display:flex;flex-direction:column}
  .it-name small{color:var(--muted);font-weight:600}
  .qty-wrap{display:flex;gap:6px;align-items:center;justify-content:flex-end}
  .qty{width:46px;text-align:center;background:#071535}
  .actions{display:flex;gap:6px;justify-content:flex-end}
  .strike{opacity:.6;text-decoration:line-through}
  .empty{color:var(--muted);text-align:center;padding:16px 8px}
  footer{opacity:.7;font-weight:600;margin:16px 4px}
  .underline-title{
    border-bottom:2px solid rgba(255,255,255,.35);padding-bottom:4px;margin-bottom:8px
  }
</style>
    </header>

    <section class="card add">
      <div class="quick" id="quick">
        <!-- quick-add favorites -->
        <button class="chip" data-emoji="ü•ö" data-name="Eggs" data-cat="Dairy">üç≥ Eggs</button>
        <button class="chip" data-emoji="ü•õ" data-name="Milk" data-cat="Dairy">ü•õ Milk</button>
        <button class="chip" data-emoji="üçû" data-name="Bread" data-cat="Bakery">üçû Bread</button>
        <button class="chip" data-emoji="üçé" data-name="Apples" data-cat="Produce">üçé Apples</button>
        <button class="chip" data-emoji="üßª" data-name="Toilet Paper" data-cat="Household">üßª TP</button>
        <button class="chip" data-emoji="üçó" data-name="Chicken" data-cat="Protein">üçó Chicken</button>
      </div>

      <form id="addForm" class="add-row" autocomplete="off">
        <input id="emoji" type="text" maxlength="3" placeholder="üõí" title="Emoji">
        <input id="name" type="text" placeholder="Add an item (e.g., Cereal)‚Ä¶" required>
        <input id="qty" type="number" min="1" value="1" title="Qty">
        <div class="cat-wrap">
          <select id="cat" title="Category">
            <option>Produce</option>
            <option>Bakery</option>
            <option>Dairy</option>
            <option>Protein</option>
            <option>Pantry</option>
            <option>Frozen</option>
            <option>Household</option>
            <option>Snacks</option>
            <option>Beverages</option>
            <option>Other</option>
          </select>
        </div>
        <button class="add-btn ok" type="submit">Add</button>
      </form>
    </section>

    <section class="lists">
      <div class="card list">
        <h2>üßæ To Buy</h2>
        <ul id="todo"></ul>
        <div id="emptyTodo" class="empty" style="display:none">Nothing here. Add something above üëÜ</div>
      </div>

      <div class="card list">
        <h2>‚úÖ Purchased <button id="clearPurchased" class="link">(clear)</button></h2>
        <ul id="done"></ul>
        <div id="emptyDone" class="empty" style="display:none">No purchased items yet.</div>
      </div>
    </section>

    <footer>Tip: tap a quick chip to auto-add with an emoji. It all saves to this device (local only).</footer>
  </div>
  <script>
  // Peter‚Äôs tiny grocery app ‚Äî localStorage only, no libraries.
  const STORAGE_KEY = "brenton-grocery-v1";

  /** @type {{items:Array<{id:string,emoji:string,name:string,qty:number,cat:string,checked:boolean,created:number}>}} */
  let state = { items: [] };

  // ---- DOM
  const $ = (sel, root=document)=>root.querySelector(sel);
  const $$ = (sel, root=document)=>[...root.querySelectorAll(sel)];
  const el = {
    search: $("#search"),
    hidePurchased: $("#hidePurchased"),
    addForm: $("#addForm"),
    emoji: $("#emoji"),
    name: $("#name"),
    qty: $("#qty"),
    cat: $("#cat"),
    todo: $("#todo"),
    done: $("#done"),
    emptyTodo: $("#emptyTodo"),
    emptyDone: $("#emptyDone"),
    clearPurchased: $("#clearPurchased"),
    clearAll: $("#clearAll"),
    shareBtn: $("#shareBtn"),
    exportBtn: $("#exportBtn"),
    importFile: $("#importFile"),
  };

  // ---- Storage
  function load(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return;
      const data = JSON.parse(raw);
      if (Array.isArray(data.items)) state.items = data.items;
    }catch(e){ console.warn("load error", e); }
  }
  function save(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  // ---- Helpers
  function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,8); }
  function cleanEmoji(s){ return (s||"").trim().slice(0,3); } // simple: let user paste emoji
  function titleCase(s){ return s.replace(/\s+/g," ").trim().replace(/\b\w/g, m => m.toUpperCase()); }

  function addItem({emoji,name,qty,cat}){
    const item = {
      id: uid(),
      emoji: cleanEmoji(emoji) || "üõí",
      name: titleCase(name),
      qty: Math.max(1, Number(qty||1)),
      cat: cat || "Other",
      checked: false,
      created: Date.now()
    };
    state.items.push(item);
    save(); render();
  }

  function updateItem(id, patch){
    const it = state.items.find(i => i.id === id);
    if (!it) return;
    Object.assign(it, patch);
    save(); render();
  }

  function deleteItem(id){
    state.items = state.items.filter(i => i.id !== id);
    save(); render();
  }

  function clearPurchased(){
    state.items = state.items.filter(i => !i.checked);
    save(); render();
  }

  function clearAll(){
    if (!confirm("Clear ALL items? This cannot be undone.")) return;
    state.items = []; save(); render();
  }

  // ---- Render
  function render(){
    const q = el.search.value.trim().toLowerCase();
    const hideDone = el.hidePurchased.checked;

    // split
    const todoItems = state.items.filter(i => !i.checked);
    const doneItems = state.items.filter(i => i.checked);

    // filter
    const matches = (it) => {
      if (!q) return true;
      return (it.name.toLowerCase().includes(q) || it.emoji.includes(q) || it.cat.toLowerCase().includes(q));
    };

    const todo = todoItems.filter(matches).sort(byCatThenName);
    const done = doneItems.filter(matches).sort(byCatThenName);

    // render lists
    el.todo.innerHTML = "";
    el.done.innerHTML = "";

    todo.forEach(it => el.todo.appendChild(itemRow(it)));
    if (!todo.length) el.emptyTodo.style.display = "block"; else el.emptyTodo.style.display = "none";

    if (hideDone){
      el.done.parentElement.style.display = "none";
    } else {
      el.done.parentElement.style.display = "";
      done.forEach(it => el.done.appendChild(itemRow(it)));
      el.emptyDone.style.display = done.length ? "none" : "block";
    }
  }

  function byCatThenName(a,b){
    return (a.cat||"").localeCompare(b.cat||"") || a.name.localeCompare(b.name);
  }

  function itemRow(it){
    const li = document.createElement("li");
    li.className = "item";
    if (it.checked) li.classList.add("checked");

    li.innerHTML = `
      <div class="it-emoji">${it.emoji}</div>
      <label class="it-name">
        <input type="checkbox" ${it.checked?"checked":""} data-role="toggle">
        <span class="${it.checked?"strike":""}">${it.name}</span>
        <small>${it.cat}</small>
      </label>
      <div class="qty-wrap">
        <button class="btn ghost" data-role="minus" title="Less">‚àí</button>
        <input class="qty" type="number" min="1" value="${it.qty}" data-role="qty">
        <button class="btn ghost" data-role="plus" title="More">Ôºã</button>
      </div>
      <div class="actions">
        <button class="btn ghost" data-role="edit" title="Edit">Edit</button>
        <button class="btn danger" data-role="del" title="Delete">Delete</button>
      </div>
    `;

    // events
    const on = (sel, ev, fn) => li.querySelector(sel)?.addEventListener(ev, fn);

    on('[data-role="toggle"]','change', e => updateItem(it.id, {checked:e.target.checked}));
    on('[data-role="minus"]','click', () => updateItem(it.id, {qty: Math.max(1, it.qty-1)}));
    on('[data-role="plus"]','click',  () => updateItem(it.id, {qty: it.qty+1}));
    on('[data-role="qty"]','change',  e => updateItem(it.id, {qty: Math.max(1, Number(e.target.value||1))}));
    on('[data-role="del"]','click',   () => deleteItem(it.id));
    on('[data-role="edit"]','click',  () => editItemPrompt(it));

    return li;
  }

  function editItemPrompt(it){
    const emoji = prompt("Emoji for item:", it.emoji) ?? it.emoji;
    const name  = prompt("Item name:", it.name) ?? it.name;
    const qty   = Number(prompt("Quantity:", it.qty) ?? it.qty) || it.qty;
    const cat   = prompt("Category (Produce/Bakery/...):", it.cat) ?? it.cat;
    updateItem(it.id, {emoji: cleanEmoji(emoji), name: titleCase(name), qty, cat});
  }

  // ---- Export / Import / Share
  function exportJSON(){
    const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "grocery-list.json"; a.click();
    URL.revokeObjectURL(url);
  }

  function importJSON(file){
    const reader = new FileReader();
    reader.onload = () => {
      try{
        const data = JSON.parse(reader.result);
        if (!data || !Array.isArray(data.items)) throw new Error("Invalid file");
        state = { items: data.items.map(coerceItem) };
        save(); render();
      }catch(e){ alert("Import failed: " + e.message); }
    };
    reader.readAsText(file);
  }

  function coerceItem(it){
    return {
      id: String(it.id || uid()),
      emoji: cleanEmoji(it.emoji)||"üõí",
      name: titleCase(String(it.name||"Item")),
      qty: Math.max(1, Number(it.qty||1)),
      cat: String(it.cat||"Other"),
      checked: !!it.checked,
      created: Number(it.created||Date.now())
    };
  }

  async function shareList(){
    const items = state.items.filter(i=>!i.checked).sort(byCatThenName);
    if (!items.length){ alert("Nothing to share ‚Äî your ‚ÄòTo Buy‚Äô list is empty."); return; }
    const lines = items.map(i => `${i.emoji} ${i.name} x${i.qty} ‚Äî ${i.cat}`);
    const text = `Grocery List:\n` + lines.join("\n");
    if (navigator.share){
      try{ await navigator.share({text}); } catch {}
    }else{
      await navigator.clipboard.writeText(text).catch(()=>{});
      alert("Copied list to clipboard!");
    }
  }

  // ---- Events
  // quick chips
  $("#quick").addEventListener("click", (e)=>{
    const btn = e.target.closest(".chip"); if (!btn) return;
    addItem({emoji:btn.dataset.emoji, name:btn.dataset.name, qty:1, cat:btn.dataset.cat});
  });

  el.addForm.addEventListener("submit", (e)=>{
    e.preventDefault();
    addItem({emoji:el.emoji.value, name:el.name.value, qty:el.qty.value, cat:el.cat.value});
    el.emoji.value = ""; el.name.value = ""; el.qty.value = 1; el.name.focus();
  });

  el.search.addEventListener("input", render);
  el.hidePurchased.addEventListener("change", render);
  el.clearPurchased.addEventListener("click", (e)=>{ e.preventDefault(); clearPurchased(); });
  el.clearAll.addEventListener("click", clearAll);
  el.exportBtn.addEventListener("click", exportJSON);
  el.importFile.addEventListener("change", (e)=> e.target.files[0] && importJSON(e.target.files[0]));
  el.shareBtn.addEventListener("click", shareList);

  // ---- Init
  load(); render();
</script>
</body>

